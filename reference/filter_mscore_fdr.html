<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Filter annotated OpenSWATH/pyProphet output table to achieve a high FDR
quality data matrix with controlled overall protein FDR and quantitative
values for all peptides mapping to these high-confidence proteins (up to a
desired overall peptide level FDR quality). — filter_mscore_fdr • SWATH2stats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Filter annotated OpenSWATH/pyProphet output table to achieve a high FDR
quality data matrix with controlled overall protein FDR and quantitative
values for all peptides mapping to these high-confidence proteins (up to a
desired overall peptide level FDR quality). — filter_mscore_fdr"><meta property="og:description" content="This function controls the protein FDR over a multi-run OpenSWATH/pyProphet
output table and filters all quantitative values to a desired overall/global
peptide FDR level.
It first finds a suitable m-score cutoff to minimally achieve a desired
global FDR quality on a protein master list based on the function
mscore4protfdr. It then finds a suitable m-score cutoff to minimally achieve
a desired global FDR quality on peptide level based on the function
mscore4pepfdr. Finally, it reports all the peptide quantities derived based
on the peptide level cutoff for only those peptides mapping to the protein
master list. It further summarizes the protein and peptide numbers remaining
after the filtering and evaluates the individual run FDR qualities of the
peptides (and quantitation events) selected."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-179575761-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-179575761-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SWATH2stats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.31.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/SWATH2stats_example_script.html">SWATH2stats example script</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://twitter.com/peterblattmann" class="external-link">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/peterblattmann/SWATH2stats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Filter annotated OpenSWATH/pyProphet output table to achieve a high FDR
quality data matrix with controlled overall protein FDR and quantitative
values for all peptides mapping to these high-confidence proteins (up to a
desired overall peptide level FDR quality).</h1>
    <small class="dont-index">Source: <a href="https://github.com/peterblattmann/SWATH2stats/blob/HEAD/R/filter_mscore_fdr.R" class="external-link"><code>R/filter_mscore_fdr.R</code></a></small>
    <div class="hidden name"><code>filter_mscore_fdr.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function controls the protein FDR over a multi-run OpenSWATH/pyProphet
output table and filters all quantitative values to a desired overall/global
peptide FDR level.
It first finds a suitable m-score cutoff to minimally achieve a desired
global FDR quality on a protein master list based on the function
mscore4protfdr. It then finds a suitable m-score cutoff to minimally achieve
a desired global FDR quality on peptide level based on the function
mscore4pepfdr. Finally, it reports all the peptide quantities derived based
on the peptide level cutoff for only those peptides mapping to the protein
master list. It further summarizes the protein and peptide numbers remaining
after the filtering and evaluates the individual run FDR qualities of the
peptides (and quantitation events) selected.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">filter_mscore_fdr</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  FFT <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  overall_protein_fdr_target <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>  upper_overall_peptide_fdr_limit <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  rm_decoy <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  score_col <span class="op">=</span> <span class="st">"m_score"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>Annotated OpenSWATH/pyProphet data table.</p></dd>


<dt>FFT</dt>
<dd><p>Ratio of false positives to true negatives, q-values from
[Injection_name]_full_stat.csv in pyProphet stats output. As an
approximation, the q-values of multiple runs are averaged and supplied as
argument FFT. Numeric from 0 to 1. Defaults to 1, the most conservative
value (1 Decoy indicates 1 False target). For further details see the
Vignette Section 1.3 and 4.1.</p></dd>


<dt>overall_protein_fdr_target</dt>
<dd><p>FDR target for the protein master list for
which quantitative values down to the less strict peptide_fdr criterion
will be kept/reported. Defaults to 0.02.</p></dd>


<dt>upper_overall_peptide_fdr_limit</dt>
<dd><p>Option to relax or tighten the false
discovery rate limit.</p></dd>


<dt>rm_decoy</dt>
<dd><p>Logical T/F, whether decoy entries should be removed after
the analysis. Defaults to TRUE. Can be useful to disable to track the
influence on decoy fraction by further filtering steps such as requiring 2
peptides per protein.</p></dd>


<dt>score_col</dt>
<dd><p>Defines the column from which to retrieve the m_score. 
If you use JPP (Rosenberger, Bludau et al. 2017) this can be used to 
select between Protein and transition_group m_score.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Returns a data frame with the filtered data.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Moritz Heusel</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="fu"><a href="OpenSWATH_data.html">data</a></span><span class="op">(</span><span class="st">"OpenSWATH_data"</span>, package<span class="op">=</span><span class="st">"SWATH2stats"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="OpenSWATH_data.html">data</a></span><span class="op">(</span><span class="st">"Study_design"</span>, package<span class="op">=</span><span class="st">"SWATH2stats"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="sample_annotation.html">sample_annotation</a></span><span class="op">(</span><span class="va">OpenSWATH_data</span>, <span class="va">Study_design</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">data.fdr.filtered</span><span class="op">&lt;-</span><span class="fu">filter_mscore_fdr</span><span class="op">(</span><span class="va">data</span>, FFT<span class="op">=</span><span class="fl">0.7</span>, </span></span>
<span class="r-in"><span>                                      overall_protein_fdr_target<span class="op">=</span><span class="fl">0.02</span>,</span></span>
<span class="r-in"><span>                                      upper_overall_peptide_fdr_limit<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Target protein FDR:0.02</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Required overall m-score cutoff:0.00017783</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> achieving protein FDR =0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> filter_mscore_fdr is filtering the data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -----------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> finding m-score cutoff to achieve desired protein FDR in protein master list..</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> finding m-score cutoff to achieve desired global peptide FDR..</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Target peptide FDR:0.1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Required overall m-score cutoff:0.01</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> achieving peptide FDR =0.00864</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Proteins selected: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Total proteins selected: 10</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Thereof target proteins: 10</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Thereof decoy proteins: 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Peptides mapping to these protein entries selected:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Total mapping peptides: 243</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Thereof target peptides: 243</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Thereof decoy peptides: 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Total peptides selected from:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Total peptides: 246</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Thereof target peptides: 246</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Thereof decoy peptides: 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Individual run FDR quality of the peptides was not calculated</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> as not every run contains a decoy.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The decoys have been removed from the returned data</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Peter Blattmann, Moritz Heusel, Ruedi Aebersold.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

