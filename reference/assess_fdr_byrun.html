<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Assess assay, peptide and protein level FDR by run (for each MS_injection
separately) in OpenSWATH output table — assess_fdr_byrun • SWATH2stats</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Assess assay, peptide and protein level FDR by run (for each MS_injection
separately) in OpenSWATH output table — assess_fdr_byrun" />
<meta property="og:description" content="This function estimates the assay, peptide and protein FDR by run in an
OpenSWATH result table in dependence of a range of m_score cutoffs. The
results can be visualized and summarized by the associated method
plot.fdr_table().
It counts target and decoy assays (unique transition_group_id), peptides
(unique FullPeptideName) and proteins (unique ProteinName) in the OpenSWATH
output table in dependence of m-score cutoff, the useful m_score cutoff range
is evaluated for each dataset individually on the fly.
To arrive from decoy counts at an estimation of the false discovery rate
(false positives among the targets remaining at a given mscore cutoff) the
ratio of false positives to true negatives (decoys) (FFT) must be
supplied. It is estimated for each run individually by pyProphet and
contained in the pyProphet statistics [Injection_name]_full_stat.csv. As an
approximation, the FFTs of multiple runs are averaged and supplied as
argument FFT. For further details see the Vignette Section 1.3 and 4.1.
To assess fdr over the entire dataset, please refer to function
assess_fdr_overall. FDR is calculated as FDR = (TN*FFT/T); TN=decoys,
T=targets, FFT=see above." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-179575761-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-179575761-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SWATH2stats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.19.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/SWATH2stats_example_script.html">SWATH2stats example script</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/peterblattmann">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/peterblattmann/SWATH2stats/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Assess assay, peptide and protein level FDR by run (for each MS_injection
separately) in OpenSWATH output table</h1>
    <small class="dont-index">Source: <a href='https://github.com/peterblattmann/SWATH2stats/blob/master/R/assess_fdr_byrun.R'><code>R/assess_fdr_byrun.R</code></a></small>
    <div class="hidden name"><code>assess_fdr_byrun.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function estimates the assay, peptide and protein FDR by run in an
OpenSWATH result table in dependence of a range of m_score cutoffs. The
results can be visualized and summarized by the associated method
plot.fdr_table().
It counts target and decoy assays (unique transition_group_id), peptides
(unique FullPeptideName) and proteins (unique ProteinName) in the OpenSWATH
output table in dependence of m-score cutoff, the useful m_score cutoff range
is evaluated for each dataset individually on the fly.
To arrive from decoy counts at an estimation of the false discovery rate
(false positives among the targets remaining at a given mscore cutoff) the
ratio of false positives to true negatives (decoys) (FFT) must be
supplied. It is estimated for each run individually by pyProphet and
contained in the pyProphet statistics [Injection_name]_full_stat.csv. As an
approximation, the FFTs of multiple runs are averaged and supplied as
argument FFT. For further details see the Vignette Section 1.3 and 4.1.
To assess fdr over the entire dataset, please refer to function
assess_fdr_overall. FDR is calculated as FDR = (TN*FFT/T); TN=decoys,
T=targets, FFT=see above.</p>
    </div>

    <pre class="usage"><span class='fu'>assess_fdr_byrun</span><span class='op'>(</span>
  <span class='va'>data</span>,
  FFT <span class='op'>=</span> <span class='fl'>1</span>,
  n_range <span class='op'>=</span> <span class='fl'>20</span>,
  output <span class='op'>=</span> <span class='st'>"pdf_csv"</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span>,
  filename <span class='op'>=</span> <span class='st'>"FDR_report_byrun"</span>,
  output_mscore_levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.01</span>, <span class='fl'>0.001</span><span class='op'>)</span>,
  score_col <span class='op'>=</span> <span class='st'>"m_score"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>Annotated OpenSWATH/pyProphet output table. Refer to function
sample_annotation from this package for further information.</p></td>
    </tr>
    <tr>
      <th>FFT</th>
      <td><p>Ratio of false positives to true negatives, q-values from
[Injection_name]_full_stat.csv in pyProphet stats output. As an
approximation, the q-values of multiple runs are averaged and supplied as
argument FFT. Numeric from 0 to 1. Defaults to 1, the most conservative
value (1 Decoy indicates 1 False target).</p></td>
    </tr>
    <tr>
      <th>n_range</th>
      <td><p>Option to set the number of magnitude for which the m_score
threshold is decreased (e.g. n_range = 10, m-score from 0.1 until
10^-10)^.</p></td>
    </tr>
    <tr>
      <th>output</th>
      <td><p>Choose output type. "pdf_csv" creates the output as files in
the working directory, "Rconsole" triggers delivery of the output to the
console enabling further computation or custom plotting / output.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>Logical, whether or not to create plots from the results (using
the associated method plot.fdr_cube()</p></td>
    </tr>
    <tr>
      <th>filename</th>
      <td><p>Modify the basename of the result files if set.</p></td>
    </tr>
    <tr>
      <th>output_mscore_levels</th>
      <td><p>Define m-score levels to plot and write the
estimated FDR results.</p></td>
    </tr>
    <tr>
      <th>score_col</th>
      <td><p>Column that contains the score. Default. m_score</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns an array of target/decoy identification numbers and
  calculated FDR values at different m-score cutoffs.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Moritz Heusel</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='op'>{</span>
 <span class='fu'><a href='OpenSWATH_data.html'>data</a></span><span class='op'>(</span><span class='st'>"OpenSWATH_data"</span>, package<span class='op'>=</span><span class='st'>"SWATH2stats"</span><span class='op'>)</span>
 <span class='fu'><a href='OpenSWATH_data.html'>data</a></span><span class='op'>(</span><span class='st'>"Study_design"</span>, package<span class='op'>=</span><span class='st'>"SWATH2stats"</span><span class='op'>)</span>
 <span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sample_annotation.html'>sample_annotation</a></span><span class='op'>(</span><span class='va'>OpenSWATH_data</span>, <span class='va'>Study_design</span><span class='op'>)</span>
 <span class='va'>assessed</span> <span class='op'>&lt;-</span> <span class='fu'>assess_fdr_byrun</span><span class='op'>(</span><span class='va'>data</span>, FFT<span class='op'>=</span><span class='fl'>0.7</span>, output<span class='op'>=</span><span class='st'>"Rconsole"</span>, plot<span class='op'>=</span><span class='cn'>TRUE</span>,
                              filename<span class='op'>=</span><span class='st'>"Testoutput_assess_fdr_byrun"</span><span class='op'>)</span>
 <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>assessed</span><span class='op'>)</span>
 <span class='op'>}</span>
</div><div class='output co'>#&gt; <span class='message'>The average FDR by run on assay level is 0.003</span></div><div class='output co'>#&gt; <span class='message'>The average FDR by run on peptide level is 0.004</span></div><div class='output co'>#&gt; <span class='message'>The average FDR by run on protein level is 0.07</span></div><div class='img'><img src='assess_fdr_byrun-1.png' alt='' width='700' height='433' /></div><div class='img'><img src='assess_fdr_byrun-2.png' alt='' width='700' height='433' /></div><div class='img'><img src='assess_fdr_byrun-3.png' alt='' width='700' height='433' /></div><div class='img'><img src='assess_fdr_byrun-4.png' alt='' width='700' height='433' /></div><div class='img'><img src='assess_fdr_byrun-5.png' alt='' width='700' height='433' /></div><div class='img'><img src='assess_fdr_byrun-6.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt;      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
#&gt;   0.00248   0.54250   0.85000  35.09810   3.25000 282.00000 </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Peter Blattmann, Moritz Heusel, Ruedi Aebersold.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


