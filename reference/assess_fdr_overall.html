<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Assess overall FDR in annotated OpenSWATH/pyProphet output table in
dependence of m_score cutoff — assess_fdr_overall • SWATH2stats</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Assess overall FDR in annotated OpenSWATH/pyProphet output table in
dependence of m_score cutoff — assess_fdr_overall" />
<meta property="og:description" content="This function estimates the assay, peptide and protein FDR over a multi-run
OpenSWATH/pyProphet output table. It counts target and decoy assays (unique
transition_group_id), peptides (unique FullPeptideName) and proteins (unique
ProteinName) in dependence of the m-score cutoff (1e-2 to 1e-20).
To arrive from decoy counts at an estimation of the false discovery rate
(false positives among the targets remaining at a given mscore cutoff) the
ratio of false positives to true negatives (decoys) (FFT) must be
supplied. It is estimated for each run individually by pyProphet and
contained in the pyProphet statistics [Injection_name]_full_stat.csv. As an
approximation, the FFTs of multiple runs are averaged and supplied as
argument FFT. For further details see the Vignette Section 1.3 and
4.1. Protein FDR control on peak group quality level is a very strict filter
and should be handled with caution.
FDR is calculated as FDR = (TN*FFT/T); TN=decoys, T=targets, FFT=see above" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-179575761-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-179575761-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SWATH2stats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.21.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/SWATH2stats_example_script.html">SWATH2stats example script</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/peterblattmann">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/peterblattmann/SWATH2stats/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Assess overall FDR in annotated OpenSWATH/pyProphet output table in
dependence of m_score cutoff</h1>
    <small class="dont-index">Source: <a href='https://github.com/peterblattmann/SWATH2stats/blob/master/R/assess_fdr_overall.R'><code>R/assess_fdr_overall.R</code></a></small>
    <div class="hidden name"><code>assess_fdr_overall.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function estimates the assay, peptide and protein FDR over a multi-run
OpenSWATH/pyProphet output table. It counts target and decoy assays (unique
transition_group_id), peptides (unique FullPeptideName) and proteins (unique
ProteinName) in dependence of the m-score cutoff (1e-2 to 1e-20).
To arrive from decoy counts at an estimation of the false discovery rate
(false positives among the targets remaining at a given mscore cutoff) the
ratio of false positives to true negatives (decoys) (FFT) must be
supplied. It is estimated for each run individually by pyProphet and
contained in the pyProphet statistics [Injection_name]_full_stat.csv. As an
approximation, the FFTs of multiple runs are averaged and supplied as
argument FFT. For further details see the Vignette Section 1.3 and
4.1. Protein FDR control on peak group quality level is a very strict filter
and should be handled with caution.
FDR is calculated as FDR = (TN*FFT/T); TN=decoys, T=targets, FFT=see above</p>
    </div>

    <pre class="usage"><span class='fu'>assess_fdr_overall</span><span class='op'>(</span>
  <span class='va'>data</span>,
  FFT <span class='op'>=</span> <span class='fl'>1</span>,
  n_range <span class='op'>=</span> <span class='fl'>20</span>,
  output <span class='op'>=</span> <span class='st'>"pdf_csv"</span>,
  plot <span class='op'>=</span> <span class='cn'>TRUE</span>,
  filename <span class='op'>=</span> <span class='st'>"FDR_report_overall"</span>,
  score_col <span class='op'>=</span> <span class='st'>"m_score"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>Data table that is produced by the OpenSWATH/pyProphet workflow</p></td>
    </tr>
    <tr>
      <th>FFT</th>
      <td><p>Ratio of false positives to true negatives, q-values from
[Injection_name]_full_stat.csv in pyProphet stats output. As an
approximation, the q-values of multiple runs are averaged and supplied as
argument FFT. Numeric from 0 to 1. Defaults to 1, the most conservative
value (1 Decoy indicates 1 False target).</p></td>
    </tr>
    <tr>
      <th>n_range</th>
      <td><p>I am also not certain what this is, nor why 20 is the
optimal default value, but I think the idea is to set up a series of mscore
thresholds.</p></td>
    </tr>
    <tr>
      <th>output</th>
      <td><p>Choose output type. "pdf_csv" creates the output as files in
the working directory, "Rconsole" triggers delivery of the output to the
console enabling further computation or custom plotting / output.</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>Logical, whether or not to create plots from the results (using
the associated method plot.fdr_table()</p></td>
    </tr>
    <tr>
      <th>filename</th>
      <td><p>Optional, modifying the basename of the result files if
applicable.</p></td>
    </tr>
    <tr>
      <th>score_col</th>
      <td><p>Column that contains the score. Default. m_score</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a list of class "fdr_table". If output "pdf_csv" and plot =
  TRUE were chosen, report files are written to the working folder.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Moritz Heusel</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='op'>{</span>
 <span class='fu'><a href='OpenSWATH_data.html'>data</a></span><span class='op'>(</span><span class='st'>"OpenSWATH_data"</span>, package<span class='op'>=</span><span class='st'>"SWATH2stats"</span><span class='op'>)</span>
 <span class='fu'><a href='OpenSWATH_data.html'>data</a></span><span class='op'>(</span><span class='st'>"Study_design"</span>, package<span class='op'>=</span><span class='st'>"SWATH2stats"</span><span class='op'>)</span>
 <span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='sample_annotation.html'>sample_annotation</a></span><span class='op'>(</span><span class='va'>OpenSWATH_data</span>, <span class='va'>Study_design</span><span class='op'>)</span>
 <span class='fu'>assess_fdr_overall</span><span class='op'>(</span><span class='va'>data</span>, FFT<span class='op'>=</span><span class='fl'>0.7</span>, output<span class='op'>=</span><span class='st'>"Rconsole"</span>, plot<span class='op'>=</span><span class='cn'>TRUE</span>,
                    filename<span class='op'>=</span><span class='st'>"Testoutput_assess_fdr_overall"</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='img'><img src='assess_fdr_overall-1.png' alt='' width='700' height='433' /></div><div class='img'><img src='assess_fdr_overall-2.png' alt='' width='700' height='433' /></div><div class='img'><img src='assess_fdr_overall-3.png' alt='' width='700' height='433' /></div><div class='img'><img src='assess_fdr_overall-4.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; $mscore_cutoff
#&gt;  [1] 1e-01 1e-02 1e-03 1e-04 1e-05 1e-06 1e-07 1e-08 1e-09 1e-10 1e-11 1e-12
#&gt; [13] 1e-13 1e-14 1e-15 1e-16 1e-17 1e-18 1e-19 1e-20
#&gt; 
#&gt; $target.assays
#&gt;  [1] 337 337 316 293 278 255 238 218 195 179 155 143 126 108 102 102 102 102 102
#&gt; [20] 102
#&gt; 
#&gt; $decoy.assays
#&gt;  [1] 3 3 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
#&gt; 
#&gt; $assay.fdr
#&gt;  [1] 0.006231454 0.006231454 0.002215190 0.000000000 0.000000000 0.000000000
#&gt;  [7] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
#&gt; [13] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
#&gt; [19] 0.000000000 0.000000000
#&gt; 
#&gt; $true.target.assays
#&gt;  [1] 334.9 334.9 315.3 293.0 278.0 255.0 238.0 218.0 195.0 179.0 155.0 143.0
#&gt; [13] 126.0 108.0 102.0 102.0 102.0 102.0 102.0 102.0
#&gt; 
#&gt; $target.peptides
#&gt;  [1] 243 243 232 218 211 196 188 181 164 154 135 129 116  99  95  95  95  95  95
#&gt; [20]  95
#&gt; 
#&gt; $decoy.peptides
#&gt;  [1] 3 3 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
#&gt; 
#&gt; $peptide.fdr
#&gt;  [1] 0.008641975 0.008641975 0.003017241 0.000000000 0.000000000 0.000000000
#&gt;  [7] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
#&gt; [13] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
#&gt; [19] 0.000000000 0.000000000
#&gt; 
#&gt; $true.target.peptides
#&gt;  [1] 240.9 240.9 231.3 218.0 211.0 196.0 188.0 181.0 164.0 154.0 135.0 129.0
#&gt; [13] 116.0  99.0  95.0  95.0  95.0  95.0  95.0  95.0
#&gt; 
#&gt; $target.proteins
#&gt;  [1] 10 10 10 10 10 10 10 10 10 10  9  9  9  9  8  8  8  8  8  8
#&gt; 
#&gt; $decoy.proteins
#&gt;  [1] 2 2 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
#&gt; 
#&gt; $protein.fdr
#&gt;  [1] 0.14 0.14 0.07 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
#&gt; [16] 0.00 0.00 0.00 0.00 0.00
#&gt; 
#&gt; $true.target.proteins
#&gt;  [1]  8.6  8.6  9.3 10.0 10.0 10.0 10.0 10.0 10.0 10.0  9.0  9.0  9.0  9.0  8.0
#&gt; [16]  8.0  8.0  8.0  8.0  8.0
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "fdr_table"</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Peter Blattmann, Moritz Heusel, Ruedi Aebersold.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


