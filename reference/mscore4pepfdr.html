<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Find m_score cutoff to reach a desired FDR on peptide level (over the entire
OpenSWATH/pyProphet output table) — mscore4pepfdr • SWATH2stats</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Find m_score cutoff to reach a desired FDR on peptide level (over the entire
OpenSWATH/pyProphet output table) — mscore4pepfdr"><meta property="og:description" content="This function estimates the m_score cutoff required in a dataset to reach a
given overall peptide level FDR.
It counts target and decoy peptides (unique FullPeptideName) at high
resolution across the m_score cutoffs and reports a useful m_score cutoff -
peptide FDR pair close to the supplied fdr_target level over the entire
dataset. The m_score cutoff is returned by the function and can be used in
the context of the filtering functions, e.g.:
data.pepFDR2pc&amp;lt;-filter_mscore(data, mscore4pepfdr(data, fdr_target=0.02))
To arrive from decoy counts at an estimation of the false discovery rate
(false positives among the targets remaining at a given mscore cutoff) the
ratio of false positives to true negatives (decoys) (FFT) must be
supplied. It is estimated for each run individually by pyProphet and
contained in the pyProphet statistics [Injection_name]_full_stat.csv. As an
approximation, the FFTs of multiple runs are averaged and supplied as
argument FFT. For further details see the Vignette Section 1.3 and 4.1.
For FDR evaluations on assay and protein level, please refer to functions
mscore4assayfdr and mscore4protfdr"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-179575761-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-179575761-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SWATH2stats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.31.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/SWATH2stats_example_script.html">SWATH2stats example script</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://twitter.com/peterblattmann" class="external-link">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/peterblattmann/SWATH2stats/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find m_score cutoff to reach a desired FDR on peptide level (over the entire
OpenSWATH/pyProphet output table)</h1>
    <small class="dont-index">Source: <a href="https://github.com/peterblattmann/SWATH2stats/blob/HEAD/R/mscore4pepfdr.R" class="external-link"><code>R/mscore4pepfdr.R</code></a></small>
    <div class="hidden name"><code>mscore4pepfdr.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function estimates the m_score cutoff required in a dataset to reach a
given overall peptide level FDR.
It counts target and decoy peptides (unique FullPeptideName) at high
resolution across the m_score cutoffs and reports a useful m_score cutoff -
peptide FDR pair close to the supplied fdr_target level over the entire
dataset. The m_score cutoff is returned by the function and can be used in
the context of the filtering functions, e.g.:
data.pepFDR2pc&lt;-filter_mscore(data, mscore4pepfdr(data, fdr_target=0.02))
To arrive from decoy counts at an estimation of the false discovery rate
(false positives among the targets remaining at a given mscore cutoff) the
ratio of false positives to true negatives (decoys) (FFT) must be
supplied. It is estimated for each run individually by pyProphet and
contained in the pyProphet statistics [Injection_name]_full_stat.csv. As an
approximation, the FFTs of multiple runs are averaged and supplied as
argument FFT. For further details see the Vignette Section 1.3 and 4.1.
For FDR evaluations on assay and protein level, please refer to functions
mscore4assayfdr and mscore4protfdr</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mscore4pepfdr</span><span class="op">(</span><span class="va">data</span>, FFT <span class="op">=</span> <span class="fl">1</span>, fdr_target <span class="op">=</span> <span class="fl">0.01</span>, mscore.col <span class="op">=</span> <span class="st">"m_score"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>Annotated OpenSWATH/pyProphet data table. See function
sample_annotation from this package.</p></dd>


<dt>FFT</dt>
<dd><p>Ratio of false positives to true negatives, q-values from
[Injection_name]_full_stat.csv in pyProphet stats output. As an
approximation, the q-values of multiple runs are averaged and supplied as
argument FFT. Numeric from 0 to 1. Defaults to 1, the most conservative
value (1 Decoy indicates 1 False target).</p></dd>


<dt>fdr_target</dt>
<dd><p>FDR target, numeric, defaults to 0.01. An m_score cutoff
achieving an FDR &lt; fdr_target will be selected.
Calculated as FDR = (TN*FFT/T); TN=decoys, T=targets, FFT=see above.</p></dd>


<dt>mscore.col</dt>
<dd><p>column in the data containing the m score data.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Returns the m_score cutoff selected to arrive at the desired FDR</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Moritz Heusel</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="fu"><a href="OpenSWATH_data.html">data</a></span><span class="op">(</span><span class="st">"OpenSWATH_data"</span>, package<span class="op">=</span><span class="st">"SWATH2stats"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="OpenSWATH_data.html">data</a></span><span class="op">(</span><span class="st">"Study_design"</span>, package<span class="op">=</span><span class="st">"SWATH2stats"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="sample_annotation.html">sample_annotation</a></span><span class="op">(</span><span class="va">OpenSWATH_data</span>, <span class="va">Study_design</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">chosen</span> <span class="op">&lt;-</span> <span class="fu">mscore4pepfdr</span><span class="op">(</span><span class="va">data</span>, FFT<span class="op">=</span><span class="fl">0.7</span>, fdr_target<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Target peptide FDR:0.01</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Required overall m-score cutoff:0.01</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> achieving peptide FDR =0.00864</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Peter Blattmann, Moritz Heusel, Ruedi Aebersold.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

