#' OpenSwathWorkflow provides a bunch of columns which are not required for mapDIA and MSstats.
#' This function will drop those extraneous columns.
#'
#' @param data SWATH2stats data to modify.
#' @param column.names Set of columns to seek out.
#' @return filtered data.
#' @export
reduce_OpenSWATH_output <- function(data, column.names=NULL) {
  if (is.null(column.names)) {
    column.names <- c("proteinname", "fullpeptidename", "sequence", "charge",
                      "aggr_fragment_annotation", "aggr_peak_area",
                      "align_origfilename", "m_score", "decoy",
                      "intensity", "rt", "run_id", "transition_group_id")
  }
  if (length(column.names) > length(column.names[column.names %in% colnames(data)])) {
    col.names.missing <- column.names[!column.names %in% colnames(data)]
    warning("These columns are missing from the data:",
            paste(unlist(col.names.missing), collapse=", "))

  }
  ## Keep only required columns for MSStats and mapDIA
  if (length(column.names) == length(column.names[column.names %in% colnames(data)])) {
    data.filtered <- data[, column.names]
    return(data.filtered)
  } else {
    message("Not modifying the data.")
    return(data)
  }
}
